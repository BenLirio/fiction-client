(this.webpackJsonpfiction=this.webpackJsonpfiction||[]).push([[0],{58:function(e,t,n){e.exports=n(85)},85:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(6),c=n.n(o),l=n(52),u=n(107),i=n(109),s=n(110),m=n(14),h=r.a.createContext({current:"",close:function(){}}),d=h,f=Object(l.a)((function(e){return{root:{width:"calc(100% - ".concat(e.drawerWidth,"px)"),marginLeft:e.drawerWidth}}})),b=function(){var e=Object(a.useContext)(d).open,t=f();return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,{className:t.root},r.a.createElement(i.a,null,r.a.createElement(s.a,{color:"inherit",onClick:function(){return e("signIn")}},"Login"))),r.a.createElement(i.a,null))},E=n(114),O=n(111),j=n(115),p=n(116),g="https://fiction-api.herokuapp.com",w="http://localhost:4741",k="localhost"===window.location.hostname?w:g,v=n(18),S=n.n(v),y=function(e){return S()({url:k+"/storys",method:"GET",headers:{Authorization:"Bearer "+e}})},x=r.a.createContext({token:null,setToken:function(){}}),C=x,N=n(22),W=Object(l.a)((function(e){return{drawer:{width:e.drawerWidth},drawerPaper:{width:e.drawerWidth}}})),P=function(){var e=Object(a.useContext)(C).token,t=Object(N.f)(),n=function(n){switch(n){case"New Story":(function(e){return S()({method:"POST",url:k+"/storys",data:{story:{title:"title",text:"text"}},headers:{Authorization:"Bearer "+e}})})(e).then((function(e){t.push("/stories/"+e.data.story._id)})).catch(console.error);break;case"Stories":y(e).then(console.log),t.push("/stories");break;default:throw new Error}},o=W();return r.a.createElement(E.a,{variant:"permanent",className:o.drawer,classes:{paper:o.drawerPaper}},r.a.createElement(O.a,null,["New Story","Stories"].map((function(e){return r.a.createElement(j.a,{onClick:function(){return n(e)},button:!0,key:e},r.a.createElement(p.a,{primary:e,className:o.listItem}))}))))},T=Object(l.a)((function(e){return{root:{display:"flex"}}})),B=function(e){var t=e.children,n=T();return r.a.createElement(r.a.Fragment,null,r.a.createElement(b,null),r.a.createElement("div",{className:n.root},r.a.createElement(P,null),t))},F=function(){var e=Object(a.useContext)(C).token,t=Object(a.useState)(null),n=Object(m.a)(t,2),r=n[0],o=n[1],c=Object(a.useState)(!1),l=Object(m.a)(c,2),u=l[0],i=l[1],s=Object(a.useState)(!0),h=Object(m.a)(s,2),d=h[0],f=h[1],b=Object(N.g)().id;return{loading:d,story:r,error:u,getStory:Object(a.useCallback)((function(){f(!0),function(e,t){return S()({url:k+"/storys/"+t,method:"GET",headers:{Authorization:"Bearer "+e}})}(e,b).then((function(e){return o(e.data.story)})).then((function(){i(!1),f(!1)})).catch((function(){f(!1),i(!0)}))}),[e,b])}},z=Object(l.a)((function(e){return{root:{width:400,height:400,background:e.palette.background.paper,boxShadow:e.shadows[3],margin:"20px auto 0"}}})),A=function(){var e=z();return r.a.createElement("div",{className:e.root},"Page")},I=function(){var e=F(),t=e.loading,n=e.story,o=e.error,c=e.getStory,l=Object(a.useContext)(C).token;return Object(a.useEffect)((function(){c()}),[l]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,t&&"Loading...."),n&&r.a.createElement(A,null),r.a.createElement("h2",null,o&&"Error"))},L=function(){var e=Object(a.useContext)(C).token,t=Object(a.useState)(null),n=Object(m.a)(t,2),r=n[0],o=n[1],c=Object(a.useState)(!1),l=Object(m.a)(c,2),u=l[0],i=l[1],s=Object(a.useState)(!0),h=Object(m.a)(s,2),d=h[0],f=h[1];return{loading:d,stories:r,error:u,getStories:Object(a.useCallback)((function(){f(!0),y(e).then((function(e){return o(e.data.storys)})).then((function(){i(!1),f(!1)})).catch((function(){f(!1),i(!0)}))}),[e])}},G=function(){var e=L(),t=e.loading,n=e.stories,o=e.error,c=e.getStories,l=Object(a.useContext)(C).token;return Object(a.useEffect)((function(){c()}),[l]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,t&&"loading..."),r.a.createElement("h1",null,n&&"Stories"),r.a.createElement("h3",null,o&&"error"))},J=function(){return r.a.createElement("div",null,"404 not found")},$=function(){var e=Object(a.useContext)(C).setToken;return Object(a.useEffect)((function(){console.log("token changed")}),[e]),r.a.createElement(B,null,r.a.createElement(N.c,null,r.a.createElement(N.a,{path:"/404"},r.a.createElement(J,null)),r.a.createElement(N.a,{exact:!0,path:"/stories"},r.a.createElement(G,null)),r.a.createElement(N.a,{path:"/stories/:id"},r.a.createElement(I,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var _=n(112),q=n(113),D=n(55),H=Object(D.a)({drawerWidth:240}),K=n(30),M=r.a.createElement((function(e){var t=e.children,n=Object(a.useState)(null),o=Object(m.a)(n,2),c=o[0],l=o[1],u={token:c,setToken:Object(a.useCallback)((function(e){l(e)}),[])};return r.a.createElement(x.Provider,{value:u},t)}),null,r.a.createElement((function(e){var t=e.children,n=Object(a.useState)("none"),o=Object(m.a)(n,2),c=o[0],l=o[1],u={current:c,close:function(){l("none")},open:function(e){l(e)}};return r.a.createElement(h.Provider,{value:u},t)}),null,r.a.createElement(_.a,{theme:H},r.a.createElement(K.a,{basename:"/fiction-client"},r.a.createElement(q.a,null),r.a.createElement($,null)))));c.a.render(M,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[58,1,2]]]);
//# sourceMappingURL=main.ddb5651b.chunk.js.map