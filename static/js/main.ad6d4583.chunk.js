(this.webpackJsonpfiction=this.webpackJsonpfiction||[]).push([[0],{102:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(8),c=n.n(o),l=n(63),i=n(133),u=n(135),s=n(136),m=n(9),d=r.a.createContext({current:"",loading:!1,close:function(){}}),f=d,b=Object(l.a)((function(e){return{root:{width:"calc(100% - ".concat(e.drawerWidth,"px)"),marginLeft:e.drawerWidth}}})),h=function(){var e=Object(a.useContext)(f).open,t=b();return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a,{className:t.root},r.a.createElement(u.a,null,r.a.createElement(s.a,{color:"inherit",onClick:function(){return e("SignIn")}},"Login"),r.a.createElement(s.a,{color:"inherit",onClick:function(){return e("SignUp")}},"Create Account"))),r.a.createElement(u.a,null))},E=n(143),p=n(137),O=n(138),g=n(144),j="https://fiction-api.herokuapp.com",w="http://localhost:4741",v="localhost"===window.location.hostname?w:j,k=n(21),S=n.n(k),C=r.a.createContext({token:null,setToken:function(){}}),x=C,y=n(28),L=Object(l.a)((function(e){return{drawer:{width:e.drawerWidth},drawerPaper:{width:e.drawerWidth}}})),N=function(){var e=Object(a.useContext)(x).token,t=Object(y.f)(),n=function(n){switch(n){case"New Story":(function(e){return S()({method:"POST",url:v+"/storys",data:{story:{title:"title",text:"text"}},headers:{Authorization:"Bearer "+e}})})(e).then((function(e){t.push("/stories/"+e.data.story._id)})).catch(console.error);break;case"Stories":t.push("/stories");break;default:throw new Error}},o=L();return r.a.createElement(E.a,{variant:"permanent",className:o.drawer,classes:{paper:o.drawerPaper}},r.a.createElement(p.a,null,["New Story","Stories"].map((function(e){return r.a.createElement(O.a,{onClick:function(){return n(e)},button:!0,key:e},r.a.createElement(g.a,{primary:e,className:o.listItem}))}))))},P=Object(l.a)((function(e){return{root:{display:"flex"}}})),T=function(e){var t=e.children,n=P();return r.a.createElement(r.a.Fragment,null,r.a.createElement(h,null),r.a.createElement("div",{className:n.root},r.a.createElement(N,null),t))},I=function(){var e=Object(a.useContext)(x).token,t=Object(a.useState)(null),n=Object(m.a)(t,2),r=n[0],o=n[1],c=Object(a.useState)(!1),l=Object(m.a)(c,2),i=l[0],u=l[1],s=Object(a.useState)(!0),d=Object(m.a)(s,2),f=d[0],b=d[1],h=Object(y.g)().id;return{loading:f,story:r,error:i,getStory:Object(a.useCallback)((function(){b(!0),function(e,t){return S()({url:v+"/storys/"+t,method:"GET",headers:{Authorization:"Bearer "+e}})}(e,h).then((function(e){return o(e.data.story)})).then((function(){u(!1),b(!1)})).catch((function(){b(!1),u(!0)}))}),[e,h])}},W=Object(l.a)((function(e){return{root:{width:400,height:400,background:e.palette.background.paper,boxShadow:e.shadows[3],margin:"20px auto 0"}}})),F=function(){var e=W();return r.a.createElement("div",{className:e.root},"Page")},A=function(){var e=I(),t=e.loading,n=e.story,o=e.error,c=e.getStory,l=Object(a.useContext)(x).token;return Object(a.useEffect)((function(){c()}),[l]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,t&&"Loading...."),n&&r.a.createElement(F,null),r.a.createElement("h2",null,o&&"Error"))},B=function(){var e=Object(a.useContext)(x).token,t=Object(a.useState)(null),n=Object(m.a)(t,2),r=n[0],o=n[1],c=Object(a.useState)(!1),l=Object(m.a)(c,2),i=l[0],u=l[1],s=Object(a.useState)(!0),d=Object(m.a)(s,2),f=d[0],b=d[1];return{loading:f,stories:r,error:i,getStories:Object(a.useCallback)((function(){b(!0),function(e){return S()({url:v+"/storys",method:"GET",headers:{Authorization:"Bearer "+e}})}(e).then((function(e){return o(e.data.storys)})).then((function(){u(!1),b(!1)})).catch((function(){b(!1),u(!0)}))}),[e])}},U=function(){var e=B(),t=e.loading,n=e.stories,o=e.error,c=e.getStories,l=Object(a.useContext)(x).token;return Object(a.useEffect)((function(){c()}),[l]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,t&&"loading..."),r.a.createElement("h1",null,n&&"Stories"),r.a.createElement("h3",null,o&&"error"))},z=function(){return r.a.createElement("div",null,"404 not found")},G=n(142),R=Object(l.a)((function(e){return{paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}})),J=function(e){var t=e.name,n=e.children,o=Object(a.useContext)(f),c=o.current,l=o.close,i=o.loading,u=o.setLoading,s=o.error,m=o.setError,d=R();console.count("modal");return r.a.createElement(r.a.Fragment,null,r.a.createElement(G.a,{open:c===t,onClose:function(){m(!1),u(!1),l()}},r.a.createElement("div",{className:d.paper},r.a.createElement("p",null,i&&"LOADING..."),r.a.createElement("p",null,s&&"!!!!ERROR!!!!"),n)))},_=n(141),D=function(e){var t=Object(a.useState)(e),n=Object(m.a)(t,2),r=n[0],o=n[1];return[r,{value:r,onChange:function(e){return o(e.target.value)}},function(){return o("")}]},$=function(){var e=Object(a.useContext)(f),t=e.setLoading,n=e.close,r=e.setError,o=Object(a.useContext)(x),c=(o.token,o.setToken);return{signUp:function(e){t(!0),r(!1),function(e){return S()({method:"POST",url:v+"/sign-up",data:{credentials:{email:e.email,password:e.password,password_confirmation:e.passwordConfirmation}}})}(e).then((function(){t(!1),n()})).catch((function(){t(!1),r(!0)}))},signIn:function(e){t(!0),r(!1),function(e){return S()({url:v+"/sign-in",method:"POST",data:{credentials:{email:e.email,password:e.password}}})}(e).then((function(e){var a=e.data;c(a.user.token),t(!1),n()})).catch((function(){t(!1),r(!0)}))}}},q=function(){var e=$().signUp,t=D(""),n=Object(m.a)(t,2),a=n[0],o=n[1],c=D(""),l=Object(m.a)(c,2),i=l[0],u=l[1],d=D(""),f=Object(m.a)(d,2),b=f[0],h=f[1];return r.a.createElement(J,{name:"SignUp"},r.a.createElement("form",null,r.a.createElement(_.a,Object.assign({label:"email"},o)),r.a.createElement(_.a,Object.assign({label:"password"},u)),r.a.createElement(_.a,Object.assign({label:"password confirmation"},h)),r.a.createElement(s.a,{onClick:function(){e({email:a,password:i,passwordConfirmation:b})}},"Login")))},H=function(){var e=D(""),t=Object(m.a)(e,2),n=t[0],a=t[1],o=D(""),c=Object(m.a)(o,2),l=c[0],i=c[1],u=$().signIn;return r.a.createElement(J,{name:"SignIn"},r.a.createElement("form",null,r.a.createElement(_.a,Object.assign({label:"email"},a)),r.a.createElement(_.a,Object.assign({label:"password"},i)),r.a.createElement(s.a,{onClick:function(){u({email:n,password:l})}},"Login")))},K=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(q,null),r.a.createElement(H,null))},M=function(){return r.a.createElement(T,null,r.a.createElement(K,null),r.a.createElement(y.c,null,r.a.createElement(y.a,{path:"/404"},r.a.createElement(z,null)),r.a.createElement(y.a,{exact:!0,path:"/stories"},r.a.createElement(U,null)),r.a.createElement(y.a,{path:"/stories/:id"},r.a.createElement(A,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Q=n(139),V=n(140),X=n(68),Y=Object(X.a)({drawerWidth:240}),Z=n(37),ee=r.a.createElement((function(e){var t=e.children,n=Object(a.useState)(null),o=Object(m.a)(n,2),c=o[0],l=o[1],i={token:c,setToken:Object(a.useCallback)((function(e){l(e)}),[])};return r.a.createElement(C.Provider,{value:i},t)}),null,r.a.createElement((function(e){var t=e.children,n=Object(a.useState)("none"),o=Object(m.a)(n,2),c=o[0],l=o[1],i=Object(a.useState)(!1),u=Object(m.a)(i,2),s=u[0],f=u[1],b=Object(a.useState)(!1),h=Object(m.a)(b,2),E={current:c,loading:s,setLoading:f,error:h[0],setError:h[1],close:function(){l("none")},open:function(e){l(e)}};return r.a.createElement(d.Provider,{value:E},t)}),null,r.a.createElement(Q.a,{theme:Y},r.a.createElement(Z.a,{basename:"/fiction-client/"},r.a.createElement(V.a,null),r.a.createElement(M,null)))));c.a.render(ee,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},75:function(e,t,n){e.exports=n(102)}},[[75,1,2]]]);
//# sourceMappingURL=main.ad6d4583.chunk.js.map