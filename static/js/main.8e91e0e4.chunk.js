(this.webpackJsonpfiction=this.webpackJsonpfiction||[]).push([[0],{101:function(e,t,n){e.exports=n(102)},102:function(e,t,n){"use strict";n.r(t),function(e){var t=n(0),a=n.n(t),r=n(11),c=n.n(r),o=n(95),l=n(93),u=n(32),i=n(28),s=n(136),f=n(137),d=n(94),m=n(31),b=n(33);console.log(e);var p=a.a.createElement(i.a,null,a.a.createElement(u.a,null,a.a.createElement(s.a,{theme:d.a},a.a.createElement(m.a,null,a.a.createElement(b.a,null,a.a.createElement(f.a,null),a.a.createElement(o.a,null))))));c.a.render(p,document.getElementById("root")),l.a()}.call(this,n(59))},28:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n(0),c=n.n(r),o=c.a.createContext({token:null,setToken:function(){}}),l=function(e){var t=e.children,n=Object(r.useState)(JSON.parse(localStorage.getItem("token"))||null),l=Object(a.a)(n,2),u=l[0],i=l[1],s={token:u,setToken:Object(r.useCallback)((function(e){i(e)}),[])};return c.a.createElement(o.Provider,{value:s},t)};t.b=o},32:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),r=n(0),c=n.n(r),o=c.a.createContext({current:"",loading:!1,close:function(){}}),l=function(e){var t=e.children,n=Object(r.useState)("none"),l=Object(a.a)(n,2),u=l[0],i=l[1],s=Object(r.useState)(!1),f=Object(a.a)(s,2),d=f[0],m=f[1],b=Object(r.useState)(!1),p=Object(a.a)(b,2),h={current:u,loading:d,setLoading:m,error:p[0],setError:p[1],close:function(){i("none")},open:function(e){i(e)}};return c.a.createElement(o.Provider,{value:h},t)};t.b=o},33:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return s}));var a=n(2),r=n(0),c=n.n(r),o=n(61),l=[],u=c.a.createContext(l),i=c.a.createContext(null),s=function(e){var t=e.children,n=Object(r.useReducer)(o.a,l),s=Object(a.a)(n,2),f=s[0],d=s[1];return c.a.createElement(u.Provider,{value:f},c.a.createElement(i.Provider,{value:d},t))};t.b=u},61:function(e,t,n){"use strict";var a=n(15);t.a=function(e,t){var n,r=t.payload;switch(t.type){case"index":return r.map((function(e){return{id:e._id,text:JSON.parse(e.text)}}));case"show":n=r._id;var c=e.filter((function(e){return e.id!==n})),o=e.find((function(e){return e.id===n}))||{};return o.text=JSON.parse(r.text),o.id=r._id,[].concat(Object(a.a)(c),[o]);case"create":var l={id:r._id,text:JSON.parse(r.text)};return[].concat(Object(a.a)(e),[l]);case"update":n=r._id;var u=e.filter((function(e){return e.id!==n})),i=e.find((function(e){return e.id===n}));return i.text=JSON.parse(r.text),[].concat(Object(a.a)(u),[i]);case"destroy":return n=r._id,e.filter((function(e){return e.id!==n}));default:throw new Error}}},93:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function a(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},94:function(e,t,n){"use strict";var a=n(64);t.a=Object(a.a)({drawerWidth:240})},95:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(87),o=n(173),l=n(174),u=n(57),i=n(28),s=n(2),f=n(166),d=n(96),m=n(171),b=n(86),p=n.n(b),h=n(32),E="https://fiction-api.herokuapp.com",v="http://localhost:4741",O="localhost"===window.location.hostname?v:E,j=n(38),g=n.n(j),w=n(37),x=function(){var e=Object(a.useContext)(h.b),t=e.setLoading,n=e.close,r=e.setError,c=Object(a.useContext)(i.b),o=c.token,l=c.setToken,u=Object(w.f)();return{signUp:function(e){t(!0),r(!1),function(e){return g()({method:"POST",url:O+"/sign-up",data:{credentials:{email:e.email,password:e.password,password_confirmation:e.passwordConfirmation}}})}(e).then((function(){t(!1),n()})).catch((function(){t(!1),r(!0)}))},signIn:function(e){t(!0),r(!1),function(e){return g()({url:O+"/sign-in",method:"POST",data:{credentials:{email:e.email,password:e.password}}})}(e).then((function(e){var a=e.data;l(a.user.token),t(!1),localStorage.setItem("token",JSON.stringify(a.user.token)),n()})).catch((function(){t(!1),r(!0)}))},signOut:function(){t(!0),r(!1),function(e){return g()({url:O+"/sign-out",method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})}(o).then((function(){l(null),t(!1),localStorage.removeItem("token"),u.push("/")})).catch((function(){t(!1),r(!0)}))}}},y=function(){var e=r.a.useState(null),t=Object(s.a)(e,2),n=t[0],a=t[1],c=x().signOut,o=function(){a(null)};return r.a.createElement("div",null,r.a.createElement(f.a,{color:"inherit",onClick:function(e){a(e.currentTarget)}},r.a.createElement(p.a,null)),r.a.createElement(d.a,{anchorEl:n,open:Boolean(n),onClose:o},r.a.createElement(m.a,{onClick:o},"Profile"),r.a.createElement(m.a,{onClick:o},"My account"),r.a.createElement(m.a,{onClick:c},"Logout")))},k=n(172),C=function(){var e=Object(a.useContext)(h.b).open;return r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{color:"inherit",onClick:function(){return e("SignIn")}},"Login"),r.a.createElement(k.a,{color:"secondary",variant:"contained",onClick:function(){return e("SignUp")}},"Create Account"))},S=Object(c.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1},title:{flexGrow:1}}})),N=function(){var e=Object(a.useContext)(i.b).token,t=S();return r.a.createElement("div",{className:t.root},r.a.createElement(o.a,{className:t.appBar},r.a.createElement(l.a,null,r.a.createElement(u.a,{variant:"h5",className:t.title},"Fiction Writer"),e?r.a.createElement(y,null):r.a.createElement(C,null))),r.a.createElement(l.a,null))},T=n(178),I=n(170),P=n(135),L=n(175),J=n(9),B=n.n(J),W=function(){var e=Object(a.useContext)(i.b).token;return Object(a.useCallback)((function(t){var n=t.url,a=void 0===n?"":n,r=t.method,c=void 0===r?"GET":r,o=t.data,l=void 0===o?{}:o;return g()({url:"".concat(O,"/").concat(a),method:c,headers:{Authorization:"Bearer "+e},data:l})}),[e])},_=n(33),z=function(){var e=Object(a.useState)(!0),t=Object(s.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(!1),o=Object(s.a)(c,2),l=o[0],u=o[1],i=Object(a.useContext)(_.c),f=W();return{index:Object(a.useCallback)((function(){var e;return B.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return u(!1),r(!0),t.prev=2,t.next=5,B.a.awrap(f({url:"storys"}));case 5:e=t.sent,i({type:"index",payload:e.data.storys}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),u(!0);case 12:r(!1);case 13:case"end":return t.stop()}}),null,null,[[2,9]])}),[f,i]),show:Object(a.useCallback)((function(e){var t;return B.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return u(!1),r(!0),n.prev=2,n.next=5,B.a.awrap(f({url:"".concat("storys","/").concat(e)}));case 5:t=n.sent,i({type:"show",payload:t.data.story}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),u(!0);case 12:r(!1);case 13:case"end":return n.stop()}}),null,null,[[2,9]])}),[f,i]),create:Object(a.useCallback)((function(e){var t;return B.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return u(!1),r(!0),n.prev=2,n.next=5,B.a.awrap(f({url:"storys",method:"POST",data:{story:{text:e}}}));case 5:t=n.sent,i({type:"create",payload:t.data.story}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),u(!0);case 12:r(!1);case 13:case"end":return n.stop()}}),null,null,[[2,9]])}),[f,i]),update:Object(a.useCallback)((function(e,t){return B.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return u(!1),r(!0),n.prev=2,n.next=5,B.a.awrap(f({url:"".concat("storys","/").concat(e),method:"PATCH",data:{story:{text:t}}}));case 5:n.sent,n.next=11;break;case 8:n.prev=8,n.t0=n.catch(2),u(!0);case 11:r(!1);case 12:case"end":return n.stop()}}),null,null,[[2,8]])}),[f,i]),destroy:Object(a.useCallback)((function(e){return B.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return u(!1),r(!0),t.prev=2,t.next=5,B.a.awrap(f({url:"".concat("storys","/").concat(e),method:"DELETE"}));case 5:i({type:"destroy",id:e}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),u(!0);case 11:r(!1);case 12:case"end":return t.stop()}}),null,null,[[2,8]])}),[f,i]),loading:n,error:l}},R=Object(c.a)((function(e){return{drawer:{width:e.drawerWidth},drawerPaper:{width:e.drawerWidth},toolbar:e.mixins.toolbar}})),A=function(){var e=z(),t=Object(w.f)(),n=R();return r.a.createElement(T.a,{variant:"permanent",className:n.drawer,classes:{paper:n.drawerPaper}},r.a.createElement("div",{className:n.toolbar}),r.a.createElement(I.a,null,["New Story","Stories"].map((function(a){return r.a.createElement(P.a,{onClick:function(){return function(n){switch(n){case"New Story":e.create();break;case"Stories":t.push("/stories");break;default:throw new Error}}(a)},button:!0,key:a},r.a.createElement(L.a,{primary:a,className:n.listItem}))}))))},F=Object(c.a)((function(e){return{root:{display:"flex"}}})),D=function(e){var t=e.children,n=F();return r.a.createElement(r.a.Fragment,null,r.a.createElement(N,null),r.a.createElement("div",{className:n.root},r.a.createElement(A,null),t))},U=(n(61),r.a.createContext({})),G=function(e){var t=e.children,n=Object(w.g)().id,c=z(),o=c.show,l=c.loading,u=c.error,i=z().update,s=Object(a.useCallback)((function(e){i(n,JSON.stringify(e))}),[n]),f=z().destroy,d=Object(a.useCallback)((function(){f(n)}),[n]);Object(a.useEffect)((function(){o(n)}),[n]);var m=Object(a.useContext)(_.b).find((function(e){return e.id===n}));return m?r.a.createElement(U.Provider,{value:{story:m,loading:l,error:u,update:s,destroy:d}},t):null},M=U,H=n(56),K=n(3),$=function(){var e=Object(a.useContext)(M),t=e.update,n=e.story,r=Object(a.useState)(n.text),c=Object(s.a)(r,2),o=c[0],l=c[1];return Object(a.useEffect)((function(){var e=setTimeout((function(){t(o)}),1e3);return function(){clearTimeout(e)}}),[o]),[o,l]},q=function(){return function(e){return r.a.createElement(u.a,Object.assign({variant:e.element.type},e))}},Q=function(){return function(e){var t=e.leaf.color,n=void 0===t?"inherit":t;return r.a.createElement("span",Object.assign({style:{color:n}},e.attributes),e.children)}},V=function(){var e=[["the","#faa"],["eht","#afa"],["the","#faa"],["eht","#afa"],["the","#faa"],["eht","#afa"],["the","#faa"],["eht","#afa"],["the","#faa"],["eht","#afa"],["the","#faa"],["eht","#afa"],["the","#faa"],["eht","#afa"]];return Object(a.useCallback)((function(t){var n=Object(s.a)(t,2),a=n[0],r=n[1],c=[];return e.forEach((function(e){if(e[0]&&K.f.isText(a)){var t=a.text.split(e[0]),n=0;t.forEach((function(t,a){0!==a&&c.push({anchor:{path:r,offset:n-e[0].length},focus:{path:r,offset:n},color:e[1]}),n=n+t.length+e[0].length}))}})),c}),[e])},X=function(){return function(e,t){return null}},Y=function(e){var t=e.normalizeNode;return e.normalizeNode=function(n){var a=Object(s.a)(n,2),r=a[0],c=a[1];if(0===c.length){var o=!0,l=!1,u=void 0;try{for(var i,f=K.c.children(e,c)[Symbol.iterator]();!(o=(i=f.next()).done);o=!0){var d=i.value,m=Object(s.a)(d,2),b=m[0],p=m[1],h=0===p[0]?"h4":"body1";b.type!==h&&K.g.setNodes(e,{type:h},{at:p})}}catch(E){l=!0,u=E}finally{try{o||null==f.return||f.return()}finally{if(l)throw u}}}return t([r,c])},e},Z=Object(c.a)((function(e){return{root:{width:400,background:e.palette.background.paper,boxShadow:e.shadows[3],margin:"20px auto 0",padding:20}}})),ee=function(){var e=Z(),t=Object(a.useMemo)((function(){return Object(H.c)(Y(Object(K.h)()))}),[]),n=$(),c=Object(s.a)(n,2),o=c[0],l=c[1],u=q(),i=Q(),f=V(),d=X();return r.a.createElement("div",{className:e.root},r.a.createElement("div",null,r.a.createElement(H.b,{editor:t,value:o,onChange:l},r.a.createElement(H.a,{placeholder:"Title...",renderElement:u,renderLeaf:i,decorate:f,onKeyDown:function(e){return d(e,t)}}))))},te=function(){var e=Object(a.useContext)(M),t=e.loading;if(e.error);else if(!t)return r.a.createElement(ee,null);return null},ne=n(130),ae=function(){return function(){return JSON.stringify([{type:"h4",children:[{text:ne().spaced}]},{type:"body1",children:[{text:"Write your fantastic story here..."}]}])}},re=n(31),ce=function(){var e=Object(a.useContext)(_.b),t=z(),n=t.index,c=t.create,o=t.loading,l=t.error,u=ae();Object(a.useEffect)((function(){n()}),[n]);var i=Object(a.useCallback)((function(){var e=u();c(e)}),[]);if(l)return r.a.createElement("p",null,"error");if(o)return r.a.createElement("p",null,"loading...");if(e)return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,e.length||"no stories"),r.a.createElement(k.a,{onClick:i},"Create story"),r.a.createElement("ul",null,e.map((function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(re.b,{to:"stories/".concat(e.id)},e.text[0].children[0].text||"no data"))}))));throw new Error},oe=function(){return r.a.createElement("div",null,"404 not found")},le=n(177),ue=Object(c.a)((function(e){return{paper:{position:"absolute",left:"50%",top:"50%",width:400,height:400,backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:e.spacing(2,4,3),borderRadius:e.shape.borderRadius,transform:"translate(-50%, -50%)"}}})),ie=function(e){var t=e.name,n=e.children,c=Object(a.useContext)(h.b),o=c.current,l=c.close,u=c.loading,i=c.setLoading,s=c.error,f=c.setError,d=ue();return r.a.createElement(le.a,{open:o===t,onClose:function(){f(!1),i(!1),l()}},r.a.createElement("div",{className:d.paper},r.a.createElement("p",null,u&&"LOADING..."),r.a.createElement("p",null,s&&"!!!!ERROR!!!!"),n))},se=n(176),fe=function(e){var t=Object(a.useState)(e),n=Object(s.a)(t,2),r=n[0],c=n[1];return[r,{value:r,onChange:function(e){return c(e.target.value)}},function(){return c("")}]},de=function(){var e=x().signUp,t=fe(""),n=Object(s.a)(t,2),a=n[0],c=n[1],o=fe(""),l=Object(s.a)(o,2),u=l[0],i=l[1],f=fe(""),d=Object(s.a)(f,2),m=d[0],b=d[1];return r.a.createElement(ie,{name:"SignUp"},r.a.createElement("form",null,r.a.createElement(se.a,Object.assign({label:"email"},c)),r.a.createElement(se.a,Object.assign({label:"password"},i)),r.a.createElement(se.a,Object.assign({label:"password confirmation"},b)),r.a.createElement(k.a,{onClick:function(){e({email:a,password:u,passwordConfirmation:m})}},"Login")))},me=function(){var e=fe(""),t=Object(s.a)(e,2),n=t[0],a=t[1],c=fe(""),o=Object(s.a)(c,2),l=o[0],u=o[1],i=x().signIn;return r.a.createElement(ie,{name:"SignIn"},r.a.createElement("form",null,r.a.createElement(se.a,Object.assign({label:"email"},a)),r.a.createElement(se.a,Object.assign({label:"password"},u)),r.a.createElement(k.a,{onClick:function(){i({email:n,password:l})}},"Login")))},be=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(de,null),r.a.createElement(me,null))};t.a=function(){return r.a.createElement(D,null,r.a.createElement(be,null),r.a.createElement(w.c,null,r.a.createElement(w.a,{path:"/404"},r.a.createElement(oe,null)),r.a.createElement(w.a,{exact:!0,path:"/stories"},r.a.createElement(ce,null)),r.a.createElement(w.a,{path:"/stories/:id"},r.a.createElement(G,null,r.a.createElement(te,null)))))}}},[[101,1,2]]]);
//# sourceMappingURL=main.8e91e0e4.chunk.js.map